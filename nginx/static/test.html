<html>

<head>
  <title>E2E</title>
</head>

<body>
  <button id="start_btn">Start</button>
  <button id="stop_btn">Stop</button>

  <script src="socket.io.dev.js"></script>
  <script src="routines.js"></script>
  <script>
    var clients = []

    function onTrack(track, stream) {
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    document.getElementById("start_btn").onclick = async () => {
      for (i = 0; i < 15; i++) {
        const id = await createUser("Sample");
        sleep(1200);
        const roomHandle = await createRoom(id.id);
        await roomHandle.join(id.id, onTrack);
        clients.push({
          client: id.id,
          room: roomHandle
        });
        sleep(500);
      }
    }

    document.getElementById("stop_btn").onclick = () => {
      clients.forEach(async (c) => await c.room.leave(c.client));
    }
  </script>
</body>

</html>
